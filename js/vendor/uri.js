/*! URI.js v1.7.2 http://medialize.github.com/URI.js/ */
/* build contains: URI.js, URITemplate.js, jquery.URI.js */
(function(i){function o(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function n(a){return"[object Array]"===String(Object.prototype.toString.call(a))}function k(a){return encodeURIComponent(a).replace(/[!'()*]/g,escape)}var g="undefined"!==typeof module&&module.exports,q=g?require("./punycode"):window.punycode,r=g?require("./IPv6"):window.IPv6,h=g?require("./SecondLevelDomains"):window.SecondLevelDomains,c=function(a,b){if(!(this instanceof c))return new c(a,b);a===i&&(a="undefined"!==
typeof location?location.href+"":"");this.href(a);return b!==i?this.absoluteTo(b):this},g=c.prototype;c.idn_expression=/[^a-z0-9\.-]/i;c.punycode_expression=/(xn--)/i;c.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;c.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;
c.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/ig;c.defaultPorts={http:"80",https:"443",ftp:"21"};c.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;c.encode=k;c.decode=decodeURIComponent;c.iso8859=function(){c.encode=escape;c.decode=unescape};c.unicode=function(){c.encode=k;c.decode=decodeURIComponent};
c.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}};
c.encodeQuery=function(a){return c.encode(a+"").replace(/%20/g,"+")};c.decodeQuery=function(a){return c.decode((a+"").replace(/\+/g,"%20"))};c.recodePath=function(a){for(var a=(a+"").split("/"),b=0,d=a.length;b<d;b++)a[b]=c.encodePathSegment(c.decode(a[b]));return a.join("/")};c.decodePath=function(a){for(var a=(a+"").split("/"),b=0,d=a.length;b<d;b++)a[b]=c.decodePathSegment(a[b]);return a.join("/")};var f={encode:"encode",decode:"decode"},e,p=function(a,b){return function(d){return c[b](d+"").replace(c.characters[a][b].expression,
function(d){return c.characters[a][b].map[d]})}};for(e in f)c[e+"PathSegment"]=p("pathname",f[e]);c.encodeReserved=p("reserved","encode");c.parse=function(a){var b,d={};b=a.indexOf("#");-1<b&&(d.fragment=a.substring(b+1)||null,a=a.substring(0,b));b=a.indexOf("?");-1<b&&(d.query=a.substring(b+1)||null,a=a.substring(0,b));"//"===a.substring(0,2)?(d.protocol="",a=a.substring(2),a=c.parseAuthority(a,d)):(b=a.indexOf(":"),-1<b&&(d.protocol=a.substring(0,b),"//"===a.substring(b+1,b+3)?(a=a.substring(b+
3),a=c.parseAuthority(a,d)):(a=a.substring(b+1),d.urn=!0)));d.path=a;return d};c.parseHost=function(a,b){var d=a.indexOf("/"),c;-1===d&&(d=a.length);"["===a[0]?(c=a.indexOf("]"),b.hostname=a.substring(1,c)||null,b.port=a.substring(c+2,d)||null):a.indexOf(":")!==a.lastIndexOf(":")?(b.hostname=a.substring(0,d)||null,b.port=null):(c=a.substring(0,d).split(":"),b.hostname=c[0]||null,b.port=c[1]||null);b.hostname&&"/"!==a.substring(d)[0]&&(d++,a="/"+a);return a.substring(d)||"/"};c.parseAuthority=function(a,
b){a=c.parseUserinfo(a,b);return c.parseHost(a,b)};c.parseUserinfo=function(a,b){var d=a.indexOf("@"),j=a.indexOf("/");-1<d&&(-1===j||d<j)?(j=a.substring(0,d).split(":"),b.username=j[0]?c.decode(j[0]):null,b.password=j[1]?c.decode(j[1]):null,a=a.substring(d+1)):(b.username=null,b.password=null);return a};c.parseQuery=function(a){if(!a)return{};a=a.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!a)return{};for(var b={},a=a.split("&"),d=a.length,j=0;j<d;j++){var f=a[j].split("="),e=c.decodeQuery(f.shift()),
f=f.length?c.decodeQuery(f.join("=")):null;b[e]?("string"===typeof b[e]&&(b[e]=[b[e]]),b[e].push(f)):b[e]=f}return b};c.build=function(a){var b="";a.protocol&&(b+=a.protocol+":");if(!a.urn&&(b||a.hostname))b+="//";b+=c.buildAuthority(a)||"";"string"===typeof a.path&&("/"!==a.path[0]&&"string"===typeof a.hostname&&(b+="/"),b+=a.path);"string"===typeof a.query&&(b+="?"+a.query);"string"===typeof a.fragment&&(b+="#"+a.fragment);return b};c.buildHost=function(a){var b="";if(a.hostname)c.ip6_expression.test(a.hostname)?
b=a.port?b+("["+a.hostname+"]:"+a.port):b+a.hostname:(b+=a.hostname,a.port&&(b+=":"+a.port));else return"";return b};c.buildAuthority=function(a){return c.buildUserinfo(a)+c.buildHost(a)};c.buildUserinfo=function(a){var b="";a.username&&(b+=c.encode(a.username),a.password&&(b+=":"+c.encode(a.password)),b+="@");return b};c.buildQuery=function(a,b){var d="",j;for(j in a)if(Object.hasOwnProperty.call(a,j)&&j)if(n(a[j]))for(var f={},e=0,h=a[j].length;e<h;e++)a[j][e]!==i&&f[a[j][e]+""]===i&&(d+="&"+c.buildQueryParameter(j,
a[j][e]),!0!==b&&(f[a[j][e]+""]=!0));else a[j]!==i&&(d+="&"+c.buildQueryParameter(j,a[j]));return d.substring(1)};c.buildQueryParameter=function(a,b){return c.encodeQuery(a)+(null!==b?"="+c.encodeQuery(b):"")};c.addQuery=function(a,b,d){if("object"===typeof b)for(var j in b)Object.prototype.hasOwnProperty.call(b,j)&&c.addQuery(a,j,b[j]);else if("string"===typeof b)a[b]===i?a[b]=d:("string"===typeof a[b]&&(a[b]=[a[b]]),n(d)||(d=[d]),a[b]=a[b].concat(d));else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");
};c.removeQuery=function(a,b,d){if(n(b))for(var d=0,j=b.length;d<j;d++)a[b[d]]=i;else if("object"===typeof b)for(j in b)Object.prototype.hasOwnProperty.call(b,j)&&c.removeQuery(a,j,b[j]);else if("string"===typeof b)if(d!==i)if(a[b]===d)a[b]=i;else{if(n(a[b])){var j=a[b],f={},e,h;if(n(d)){e=0;for(h=d.length;e<h;e++)f[d[e]]=!0}else f[d]=!0;e=0;for(h=j.length;e<h;e++)f[j[e]]!==i&&(j.splice(e,1),h--,e--);a[b]=j}}else a[b]=i;else throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");
};c.commonPath=function(a,b){var d=Math.min(a.length,b.length),c;for(c=0;c<d;c++)if(a[c]!==b[c]){c--;break}if(1>c)return a[0]===b[0]&&"/"===a[0]?"/":"";"/"!==a[c]&&(c=a.substring(0,c).lastIndexOf("/"));return a.substring(0,c+1)};c.withinString=function(a,b){return a.replace(c.find_uri_expression,b)};c.ensureValidHostname=function(a){if(a.match(c.invalid_hostname_characters)){if(!q)throw new TypeError("Hostname '"+a+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available");if(q.toASCII(a).match(c.invalid_hostname_characters))throw new TypeError("Hostname '"+
a+"' contains characters other than [A-Z0-9.-]");}};g.build=function(a){if(!0===a)this._deferred_build=!0;else if(a===i||this._deferred_build)this._string=c.build(this._parts),this._deferred_build=!1;return this};g.clone=function(){return new c(this)};g.toString=function(){return this.build(!1)._string};g.valueOf=function(){return this.toString()};f={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"};p=function(a){return function(b,d){if(b===i)return this._parts[a]||
"";this._parts[a]=b;this.build(!d);return this}};for(e in f)g[e]=p(f[e]);f={query:"?",fragment:"#"};p=function(a,b){return function(d,c){if(d===i)return this._parts[a]||"";null!==d&&(d+="",d[0]===b&&(d=d.substring(1)));this._parts[a]=d;this.build(!c);return this}};for(e in f)g[e]=p(e,f[e]);f={search:["?","query"],hash:["#","fragment"]};p=function(a,b){return function(c,j){var f=this[a](c,j);return"string"===typeof f&&f.length?b+f:f}};for(e in f)g[e]=p(f[e][1],f[e][0]);g.pathname=function(a,b){if(a===
i||!0===a){var d=this._parts.path||(this._parts.urn?"":"/");return a?c.decodePath(d):d}this._parts.path=a?c.recodePath(a):"/";this.build(!b);return this};g.path=g.pathname;g.href=function(a,b){if(a===i)return this.toString();this._string="";this._parts={protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null};var d=a instanceof c,j="object"===typeof a&&(a.hostname||a.path),f;if("string"===typeof a)this._parts=c.parse(a);else if(d||j)for(f in d=
d?a._parts:a,d)Object.hasOwnProperty.call(this._parts,f)&&(this._parts[f]=d[f]);else throw new TypeError("invalid input");this.build(!b);return this};g.is=function(a){var b=!1,d=!1,j=!1,f=!1,e=!1,g=!1,i=!1,p=!this._parts.urn;this._parts.hostname&&(p=!1,d=c.ip4_expression.test(this._parts.hostname),j=c.ip6_expression.test(this._parts.hostname),b=d||j,e=(f=!b)&&h&&h.has(this._parts.hostname),g=f&&c.idn_expression.test(this._parts.hostname),i=f&&c.punycode_expression.test(this._parts.hostname));switch(a.toLowerCase()){case "relative":return p;
case "absolute":return!p;case "domain":case "name":return f;case "sld":return e;case "ip":return b;case "ip4":case "ipv4":case "inet4":return d;case "ip6":case "ipv6":case "inet6":return j;case "idn":return g;case "url":return!this._parts.urn;case "urn":return!!this._parts.urn;case "punycode":return i}return null};var s=g.protocol,l=g.port,m=g.hostname;g.protocol=function(a,b){if(a!==i&&a&&(a=a.replace(/:(\/\/)?$/,""),a.match(/[^a-zA-z0-9\.+-]/)))throw new TypeError("Protocol '"+a+"' contains characters other than [A-Z0-9.+-]");
return s.call(this,a,b)};g.scheme=g.protocol;g.port=function(a,b){if(this._parts.urn)return a===i?"":this;if(a!==i&&(0===a&&(a=null),a&&(a+="",":"===a[0]&&(a=a.substring(1)),a.match(/[^0-9]/))))throw new TypeError("Port '"+a+"' contains characters other than [0-9]");return l.call(this,a,b)};g.hostname=function(a,b){if(this._parts.urn)return a===i?"":this;if(a!==i){var d={};c.parseHost(a,d);a=d.hostname}return m.call(this,a,b)};g.host=function(a,b){if(this._parts.urn)return a===i?"":this;if(a===i)return this._parts.hostname?
c.buildHost(this._parts):"";c.parseHost(a,this._parts);this.build(!b);return this};g.authority=function(a,b){if(this._parts.urn)return a===i?"":this;if(a===i)return this._parts.hostname?c.buildAuthority(this._parts):"";c.parseAuthority(a,this._parts);this.build(!b);return this};g.userinfo=function(a,b){if(this._parts.urn)return a===i?"":this;if(a===i){if(!this._parts.username)return"";var d=c.buildUserinfo(this._parts);return d.substring(0,d.length-1)}"@"!==a[a.length-1]&&(a+="@");c.parseUserinfo(a,
this._parts);this.build(!b);return this};g.subdomain=function(a,b){if(this._parts.urn)return a===i?"":this;if(a===i){if(!this._parts.hostname||this.is("IP"))return"";var d=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,d)||""}d=this._parts.hostname.length-this.domain().length;d=this._parts.hostname.substring(0,d);d=RegExp("^"+o(d));a&&"."!==a[a.length-1]&&(a+=".");a&&c.ensureValidHostname(a);this._parts.hostname=this._parts.hostname.replace(d,a);this.build(!b);
return this};g.domain=function(a,b){if(this._parts.urn)return a===i?"":this;"boolean"===typeof a&&(b=a,a=i);if(a===i){if(!this._parts.hostname||this.is("IP"))return"";var d=this._parts.hostname.match(/\./g);if(d&&2>d.length)return this._parts.hostname;d=this._parts.hostname.length-this.tld(b).length-1;d=this._parts.hostname.lastIndexOf(".",d-1)+1;return this._parts.hostname.substring(d)||""}if(!a)throw new TypeError("cannot set domain empty");c.ensureValidHostname(a);!this._parts.hostname||this.is("IP")?
this._parts.hostname=a:(d=RegExp(o(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(d,a));this.build(!b);return this};g.tld=function(a,b){if(this._parts.urn)return a===i?"":this;"boolean"===typeof a&&(b=a,a=i);if(a===i){if(!this._parts.hostname||this.is("IP"))return"";var c=this._parts.hostname.lastIndexOf("."),c=this._parts.hostname.substring(c+1);return!0!==b&&h&&h.list[c.toLowerCase()]?h.get(this._parts.hostname)||c:c}if(a)if(a.match(/[^a-zA-Z0-9-]/))if(h&&h.is(a))c=RegExp(o(this.tld())+
"$"),this._parts.hostname=this._parts.hostname.replace(c,a);else throw new TypeError("TLD '"+a+"' contains characters other than [A-Z0-9]");else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");c=RegExp(o(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(c,a)}else throw new TypeError("cannot set TLD empty");this.build(!b);return this};g.directory=function(a,b){if(this._parts.urn)return a===i?"":this;if(a===i||!0===a){if(!this._parts.path&&
!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var d=this._parts.path.length-this.filename().length-1,d=this._parts.path.substring(0,d)||(this._parts.hostname?"/":"");return a?c.decodePath(d):d}d=this._parts.path.length-this.filename().length;d=this._parts.path.substring(0,d);d=RegExp("^"+o(d));this.is("relative")||(a||(a="/"),"/"!==a[0]&&(a="/"+a));a&&"/"!==a[a.length-1]&&(a+="/");a=c.recodePath(a);this._parts.path=this._parts.path.replace(d,a);this.build(!b);return this};g.filename=
function(a,b){if(this._parts.urn)return a===i?"":this;if(a===i||!0===a){if(!this._parts.path||"/"===this._parts.path)return"";var d=this._parts.path.lastIndexOf("/"),d=this._parts.path.substring(d+1);return a?c.decodePathSegment(d):d}d=!1;"/"===a[0]&&(a=a.substring(1));a.match(/\.?\//)&&(d=!0);var f=RegExp(o(this.filename())+"$"),a=c.recodePath(a);this._parts.path=this._parts.path.replace(f,a);d?this.normalizePath(b):this.build(!b);return this};g.suffix=function(a,b){if(this._parts.urn)return a===
i?"":this;if(a===i||!0===a){if(!this._parts.path||"/"===this._parts.path)return"";var d=this.filename(),f=d.lastIndexOf(".");if(-1===f)return"";d=d.substring(f+1);d=/^[a-z0-9%]+$/i.test(d)?d:"";return a?c.decodePathSegment(d):d}"."===a[0]&&(a=a.substring(1));if(d=this.suffix())f=a?RegExp(o(d)+"$"):RegExp(o("."+d)+"$");else{if(!a)return this;this._parts.path+="."+c.recodePath(a)}f&&(a=c.recodePath(a),this._parts.path=this._parts.path.replace(f,a));this.build(!b);return this};g.segment=function(a,b,
c){var f=this._parts.urn?":":"/",e=this.path(),h="/"===e.substring(0,1),e=e.split(f);"number"!==typeof a&&(c=b,b=a,a=i);if(a!==i&&"number"!==typeof a)throw Error("Bad segment '"+a+"', must be 0-based integer");h&&e.shift();0>a&&(a=Math.max(e.length+a,0));if(b===i)return a===i?e:e[a];if(null===a||e[a]===i)if(n(b))e=b;else{if(b||"string"===typeof b&&b.length)""===e[e.length-1]?e[e.length-1]=b:e.push(b)}else b||"string"===typeof b&&b.length?e[a]=b:e.splice(a,1);h&&e.unshift("");return this.path(e.join(f),
c)};var t=g.query;g.query=function(a,b){return!0===a?c.parseQuery(this._parts.query):a!==i&&"string"!==typeof a?(this._parts.query=c.buildQuery(a),this.build(!b),this):t.call(this,a,b)};g.addQuery=function(a,b,d){var f=c.parseQuery(this._parts.query);c.addQuery(f,a,b);this._parts.query=c.buildQuery(f);"string"!==typeof a&&(d=b);this.build(!d);return this};g.removeQuery=function(a,b,d){var f=c.parseQuery(this._parts.query);c.removeQuery(f,a,b);this._parts.query=c.buildQuery(f);"string"!==typeof a&&
(d=b);this.build(!d);return this};g.addSearch=g.addQuery;g.removeSearch=g.removeQuery;g.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()};g.normalizeProtocol=function(a){"string"===typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!a));return this};
g.normalizeHostname=function(a){this._parts.hostname&&(this.is("IDN")&&q?this._parts.hostname=q.toASCII(this._parts.hostname):this.is("IPv6")&&r&&(this._parts.hostname=r.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!a));return this};g.normalizePort=function(a){"string"===typeof this._parts.protocol&&this._parts.port===c.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!a));return this};g.normalizePath=function(a){if(this._parts.urn||
!this._parts.path||"/"===this._parts.path)return this;var b,d,f=this._parts.path,e,h;"/"!==f[0]&&("."===f[0]&&(d=f.substring(0,f.indexOf("/"))),b=!0,f="/"+f);for(f=f.replace(/(\/(\.\/)+)|\/{2,}/g,"/");;){e=f.indexOf("/../");if(-1===e)break;else if(0===e){f=f.substring(3);break}h=f.substring(0,e).lastIndexOf("/");-1===h&&(h=e);f=f.substring(0,h)+f.substring(e+3)}b&&this.is("relative")&&(f=d?d+f:f.substring(1));f=c.recodePath(f);this._parts.path=f;this.build(!a);return this};g.normalizePathname=g.normalizePath;
g.normalizeQuery=function(a){"string"===typeof this._parts.query&&(this._parts.query.length?this.query(c.parseQuery(this._parts.query)):this._parts.query=null,this.build(!a));return this};g.normalizeFragment=function(a){this._parts.fragment||(this._parts.fragment=null,this.build(!a));return this};g.normalizeSearch=g.normalizeQuery;g.normalizeHash=g.normalizeFragment;g.iso8859=function(){var a=c.encode,b=c.decode;c.encode=escape;c.decode=decodeURIComponent;this.normalize();c.encode=a;c.decode=b;return this};
g.unicode=function(){var a=c.encode,b=c.decode;c.encode=k;c.decode=unescape;this.normalize();c.encode=a;c.decode=b;return this};g.readable=function(){var a=this.clone();a.username("").password("").normalize();var b="";a._parts.protocol&&(b+=a._parts.protocol+"://");a._parts.hostname&&(a.is("punycode")&&q?(b+=q.toUnicode(a._parts.hostname),a._parts.port&&(b+=":"+a._parts.port)):b+=a.host());a._parts.hostname&&(a._parts.path&&"/"!==a._parts.path[0])&&(b+="/");b+=a.path(!0);if(a._parts.query){for(var d=
"",f=0,e=a._parts.query.split("&"),h=e.length;f<h;f++){var g=(e[f]||"").split("="),d=d+("&"+c.decodeQuery(g[0]).replace(/&/g,"%26"));g[1]!==i&&(d+="="+c.decodeQuery(g[1]).replace(/&/g,"%26"))}b+="?"+d.substring(1)}return b+=a.hash()};g.absoluteTo=function(a){var b=this.clone(),d=["protocol","username","password","hostname","port"],f,e;if(this._parts.urn)throw Error("URNs do not have any generally defined hierachical components");if(this._parts.hostname)return b;a instanceof c||(a=new c(a));f=0;for(e;e=
d[f];f++)b._parts[e]=a._parts[e];d=["query","path"];f=0;for(e;e=d[f];f++)!b._parts[e]&&a._parts[e]&&(b._parts[e]=a._parts[e]);"/"!==b.path()[0]&&(a=a.directory(),b._parts.path=(a?a+"/":"")+b._parts.path,b.normalizePath());b.build();return b};g.relativeTo=function(a){var b=this.clone(),d=["protocol","username","password","hostname","port"],f;if(this._parts.urn)throw Error("URNs do not have any generally defined hierachical components");a instanceof c||(a=new c(a));if("/"!==this.path()[0]||"/"!==a.path()[0])throw Error("Cannot calculate common path from non-relative URLs");
f=c.commonPath(b.path(),a.path());for(var a=a.directory(),e=0,h;h=d[e];e++)b._parts[h]=null;if(!f||"/"===f)return b;if(a+"/"===f)b._parts.path="./"+b.filename();else{d="../";f=RegExp("^"+o(f));for(a=a.replace(f,"/").match(/\//g).length-1;a--;)d+="../";b._parts.path=b._parts.path.replace(f,d)}b.build();return b};g.equals=function(a){var b=this.clone(),f=new c(a),e={},h={},a={},g;b.normalize();f.normalize();if(b.toString()===f.toString())return!0;e=b.query();h=f.query();b.query("");f.query("");if(b.toString()!==
f.toString()||e.length!==h.length)return!1;e=c.parseQuery(e);h=c.parseQuery(h);for(g in e)if(Object.prototype.hasOwnProperty.call(e,g)){if(n(e[g])){if(!n(h[g])||e[g].length!==h[g].length)return!1;e[g].sort();h[g].sort();b=0;for(f=e[g].length;b<f;b++)if(e[g][b]!==h[g][b])return!1}else if(e[g]!==h[g])return!1;a[g]=!0}for(g in h)if(Object.prototype.hasOwnProperty.call(h,g)&&!a[g])return!1;return!0};"undefined"!==typeof module&&module.exports?module.exports=c:window.URI=c})();
(function(i){var o=Object.prototype.hasOwnProperty,n="undefined"!==typeof module&&module.exports?require("./URI"):window.URI,k=function(h){if(k._cache[h])return k._cache[h];if(!(this instanceof k))return new k(h);this.expression=h;k._cache[h]=this;return this},g=function(h){this.data=h;this.cache={}},q=k.prototype,r={"":{prefix:"",separator:",",named:!1,empty_name_separator:!1,encode:"encode"},"+":{prefix:"",separator:",",named:!1,empty_name_separator:!1,encode:"encodeReserved"},"#":{prefix:"#",separator:",",
named:!1,empty_name_separator:!1,encode:"encodeReserved"},".":{prefix:".",separator:".",named:!1,empty_name_separator:!1,encode:"encode"},"/":{prefix:"/",separator:"/",named:!1,empty_name_separator:!1,encode:"encode"},";":{prefix:";",separator:";",named:!0,empty_name_separator:!1,encode:"encode"},"?":{prefix:"?",separator:"&",named:!0,empty_name_separator:!0,encode:"encode"},"&":{prefix:"&",separator:"&",named:!0,empty_name_separator:!0,encode:"encode"}};k._cache={};k.EXPRESSION_PATTERN=/\{([^a-zA-Z0-9%_]?)([^\}]+)(\}|$)/g;
k.VARIABLE_PATTERN=/^([^*:]+)((\*)|:(\d+))?$/;k.VARIABLE_NAME_PATTERN=/[^a-zA-Z0-9%_]/;k.expand=function(h,c){var f=r[h.operator],e=f.named?"Named":"Unnamed",g=h.variables,i=[],l,m,n;for(n=0;m=g[n];n++)l=c.get(m.name),l.val.length?i.push(k["expand"+e](l,f,m.explode,m.explode&&f.separator||",",m.maxlength,m.name)):l.type&&i.push("");return i.length?f.prefix+i.join(f.separator):""};k.expandNamed=function(h,c,f,e,g,s){var l="",m=c.encode,c=c.empty_name_separator,k=!h[m].length,a=2===h.type?"":n[m](s),
b,d,j;d=0;for(j=h.val.length;d<j;d++)(g?(b=n[m](h.val[d][1].substring(0,g)),2===h.type&&(a=n[m](h.val[d][0].substring(0,g)))):k?(b=n[m](h.val[d][1]),2===h.type?(a=n[m](h.val[d][0]),h[m].push([a,b])):h[m].push([i,b])):(b=h[m][d][1],2===h.type&&(a=h[m][d][0])),l&&(l+=e),f)?l+=a+(c||b?"=":"")+b:(d||(l+=n[m](s)+(c||b?"=":"")),2===h.type&&(l+=a+","),l+=b);return l};k.expandUnnamed=function(h,c,f,e,g){var k="",l=c.encode,c=c.empty_name_separator,m=!h[l].length,o,a,b,d;b=0;for(d=h.val.length;b<d;b++)g?a=
n[l](h.val[b][1].substring(0,g)):m?(a=n[l](h.val[b][1]),h[l].push([2===h.type?n[l](h.val[b][0]):i,a])):a=h[l][b][1],k&&(k+=e),2===h.type&&(o=g?n[l](h.val[b][0].substring(0,g)):h[l][b][0],k+=o,k=f?k+(c||a?"=":""):k+","),k+=a;return k};q.expand=function(h){var c="";(!this.parts||!this.parts.length)&&this.parse();h instanceof g||(h=new g(h));for(var f=0,e=this.parts.length;f<e;f++)c+="string"===typeof this.parts[f]?this.parts[f]:k.expand(this.parts[f],h);return c};q.parse=function(){var g=this.expression,
c=k.EXPRESSION_PATTERN,f=k.VARIABLE_PATTERN,e=k.VARIABLE_NAME_PATTERN,i=[],n=0,l,m,o;for(c.lastIndex=0;;){m=c.exec(g);if(null===m){i.push(g.substring(n));break}else i.push(g.substring(n,m.index)),n=m.index+m[0].length;if(r[m[1]]){if(!m[3])throw Error('Unclosed Expression "'+m[0]+'"');}else throw Error('Unknown Operator "'+m[1]+'" in "'+m[0]+'"');l=m[2].split(",");for(var a=0,b=l.length;a<b;a++){o=l[a].match(f);if(null===o)throw Error('Invalid Variable "'+l[a]+'" in "'+m[0]+'"');if(o[1].match(e))throw Error('Invalid Variable Name "'+
o[1]+'" in "'+m[0]+'"');l[a]={name:o[1],explode:!!o[3],maxlength:o[4]&&parseInt(o[4],10)}}if(!l.length)throw Error('Expression Missing Variable(s) "'+m[0]+'"');i.push({expression:m[0],operator:m[1],variables:l})}i.length||i.push(g);this.parts=i;return this};g.prototype.get=function(g){var c=this.data,f={type:0,val:[],encode:[],encodeReserved:[]},e;if(this.cache[g]!==i)return this.cache[g];this.cache[g]=f;c="[object Function]"===String(Object.prototype.toString.call(c))?c(g):"[object Function]"===
String(Object.prototype.toString.call(c[g]))?c[g](g):c[g];if(c===i||null===c)return f;if("[object Array]"===String(Object.prototype.toString.call(c))){e=0;for(g=c.length;e<g;e++)c[e]!==i&&null!==c[e]&&f.val.push([i,String(c[e])]);f.val.length&&(f.type=3)}else if("[object Object]"===String(Object.prototype.toString.call(c))){for(e in c)o.call(c,e)&&(c[e]!==i&&null!==c[e])&&f.val.push([e,String(c[e])]);f.val.length&&(f.type=2)}else f.type=1,f.val.push([i,String(c)]);return f};n.expand=function(g,c){var f=
(new k(g)).expand(c);return new n(f)};"undefined"!==typeof module&&module.exports?module.exports=k:window.URITemplate=k})();
(function(i,o){function n(c){return c.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function k(c){var e;i.each(["href","src","action"],function(g,h){return h in c?(e=h,!1):!0});return"input"===c.nodeName.toLowerCase()&&"image"!==c.type?o:e}var g="undefined"!==typeof module&&module.exports?require("./URIjs"):window.URI,q=/^([a-zA-Z]+)\s*([\^\$*]?=|:)\s*(['"]?)(.+)\3|^\s*([a-zA-Z0-9]+)\s*$/,r={},h={"=":function(c,e){return c===e},"^=":function(c,e){return!!(c+"").match(RegExp("^"+n(e),"i"))},"$=":function(c,
e){return!!(c+"").match(RegExp(n(e)+"$","i"))},"*=":function(c,e,g){"directory"==g&&(c+="/");return!!(c+"").match(RegExp(n(e),"i"))},"equals:":function(c,e){return c.equals(e)},"is:":function(c,e){return c.is(e)}};i.each("authority directory domain filename fragment hash host hostname href password path pathname port protocol query scheme search subdomain suffix tld username".split(" "),function(c,e){r[e]=true;i.attrHooks["uri:"+e]={get:function(c){return i(c).uri()[e]()},set:function(c,f){i(c).uri()[e](f);
return f}}});i.fn.uri=function(c){var e=this.first(),h=e.get(0),i=k(h);if(!i)throw Error('Element "'+h.nodeName+'" does not have either property: href, src, action');if(c!==o){var l=e.data("uri");if(l)return l.href(c);c instanceof g||(c=g(c))}else{if(c=e.data("uri"))return c;c=g(e.attr(i))}c._dom_element=h;c._dom_attribute=i;c.normalize();e.data("uri",c);return c};g.prototype.build=function(c){if(this._dom_element)this._string=g.build(this._parts),this._deferred_build=!1,this._dom_element.setAttribute(this._dom_attribute,
this._string),this._dom_element[this._dom_attribute]=this._string;else if(!0===c)this._deferred_build=!0;else if(c===o||this._deferred_build)this._string=g.build(this._parts),this._deferred_build=!1;return this};i.expr.filters.uri=function(c,e,g){if(!k(c)||!g[3])return!1;e=g[3].match(q);if(!e||!e[5]&&":"!==e[2]&&!h[e[2]])return!1;g=i(c).uri();if(e[5])return g.is(e[5]);if(":"===e[2])return c=e[1].toLowerCase()+":",!h[c]?!1:h[c](g,e[4]);c=e[1].toLowerCase();return!r[c]?!1:h[e[2]](g[c](),e[4],c)};var c=
function(c,e){return i(c).uri().href(e).toString()};i.each(["src","href","action","uri"],function(f,e){i.attrHooks[e]={set:c}});i.attrHooks.uri.get=function(c){return i(c).uri()}})(jQuery);